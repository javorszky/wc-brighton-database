<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>"Things you didn't know you need to know about WordPress and databases" talk by Gabor Javorszky – WordCamp Brighton, 18th August 2017</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/solarized.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">



				<section>
					<h1>Things you didn't know you need to know about WordPress and databases</h2>

					<p class="fragment">crash course into database architecture</p>
					<aside class="notes">
						<p><small>(full disclosure: I'm not a certified DB architect)</small></p>
					</aside>
				</section>






				<section>
					<h1>Assumptions</h1>
					<ol>
						<li>
							<p>Site is large with lots of data</p>
						</li>
						<li>
							<p>potentially one with WooCommerce</p>
						</li>
						<li>
							<p>InnoDB storage engine (your WordPress site most probably uses this by default)</p>
						</li>
					</ol>
				</section>




				<section>
					<h2>common (slow) queries</h2>
					<blockquote>get me all the orders for user 4</blockquote>
					<blockquote>get me all subscriptions where the next payment date is between X and Y</blockquote>
					<blockquote>get me all orders where the total is $19.92</blockquote>
					<blockquote>get me the sum of all order totals where the order date is in May and order by order total. or date</blockquote>
				</section>




				<section>
					<blockquote>basically doing anything on the admin area</blockquote>
				</section>




				<section>
					<p>All of those are going to be</p>
					<p class="fragment">...really...</p>
					<p class="fragment">...slow.</p>
				</section>




				<section>
					<h1>The Talk</h1>
					<ul>
						<li>indexes and how to use them</li>
						<li>storing data in multiple tables vs one table - foreign keys and why they're awesome</li>
						<li>tools to measure stuff</li>
					</ul>
					<aside class="notes">
						<p>Can I help existing sites? - probably not</p>
						<p>Can I help you build better plugins / themes? - hope so</p>
					</aside>
				</section>




				<section>
					<h1>Indexes</h1>
					<p>What are they?</p>
					<p>Why are they important?</p>
					<p>How do they work?</p>
					<p>Indexable, unindexable (looking at you, postmeta value!)</p>
				</section>




				<section>
					<h1>What are indexes</h1>
				</section>




				<section>
					<img src="assets/pix/j-zamora-267753.jpg" alt="library">
					<a style="background-color:black;color:white;text-decoration:none;padding:4px 6px;font-family:-apple-system, BlinkMacSystemFont, &quot;San Francisco&quot;, &quot;Helvetica Neue&quot;, Helvetica, Ubuntu, Roboto, Noto, &quot;Segoe UI&quot;, Arial, sans-serif;font-size:12px;font-weight:bold;line-height:1.2;display:inline-block;border-radius:3px;" href="https://unsplash.com/@jzamora?utm_medium=referral&amp;utm_campaign=photographer-credit&amp;utm_content=creditBadge" target="_blank" rel="noopener noreferrer" title="Download free do whatever you want high-resolution photos from j zamora"><span style="display:inline-block;padding:2px 3px;"><svg xmlns="http://www.w3.org/2000/svg" style="height:12px;width:auto;position:relative;vertical-align:middle;top:-1px;fill:white;" viewBox="0 0 32 32"><title></title><path d="M20.8 18.1c0 2.7-2.2 4.8-4.8 4.8s-4.8-2.1-4.8-4.8c0-2.7 2.2-4.8 4.8-4.8 2.7.1 4.8 2.2 4.8 4.8zm11.2-7.4v14.9c0 2.3-1.9 4.3-4.3 4.3h-23.4c-2.4 0-4.3-1.9-4.3-4.3v-15c0-2.3 1.9-4.3 4.3-4.3h3.7l.8-2.3c.4-1.1 1.7-2 2.9-2h8.6c1.2 0 2.5.9 2.9 2l.8 2.4h3.7c2.4 0 4.3 1.9 4.3 4.3zm-8.6 7.5c0-4.1-3.3-7.5-7.5-7.5-4.1 0-7.5 3.4-7.5 7.5s3.3 7.5 7.5 7.5c4.2-.1 7.5-3.4 7.5-7.5z"></path></svg></span><span style="display:inline-block;padding:2px 3px;">j zamora</span></a>
				</section>




				<section>
					<img src="assets/pix/sanwal-deen-93466.jpg" alt="library index">
					<a style="background-color:black;color:white;text-decoration:none;padding:4px 6px;font-family:-apple-system, BlinkMacSystemFont, &quot;San Francisco&quot;, &quot;Helvetica Neue&quot;, Helvetica, Ubuntu, Roboto, Noto, &quot;Segoe UI&quot;, Arial, sans-serif;font-size:12px;font-weight:bold;line-height:1.2;display:inline-block;border-radius:3px;" href="https://unsplash.com/@sanwaldeen?utm_medium=referral&amp;utm_campaign=photographer-credit&amp;utm_content=creditBadge" target="_blank" rel="noopener noreferrer" title="Download free do whatever you want high-resolution photos from Sanwal Deen"><span style="display:inline-block;padding:2px 3px;"><svg xmlns="http://www.w3.org/2000/svg" style="height:12px;width:auto;position:relative;vertical-align:middle;top:-1px;fill:white;" viewBox="0 0 32 32"><title></title><path d="M20.8 18.1c0 2.7-2.2 4.8-4.8 4.8s-4.8-2.1-4.8-4.8c0-2.7 2.2-4.8 4.8-4.8 2.7.1 4.8 2.2 4.8 4.8zm11.2-7.4v14.9c0 2.3-1.9 4.3-4.3 4.3h-23.4c-2.4 0-4.3-1.9-4.3-4.3v-15c0-2.3 1.9-4.3 4.3-4.3h3.7l.8-2.3c.4-1.1 1.7-2 2.9-2h8.6c1.2 0 2.5.9 2.9 2l.8 2.4h3.7c2.4 0 4.3 1.9 4.3 4.3zm-8.6 7.5c0-4.1-3.3-7.5-7.5-7.5-4.1 0-7.5 3.4-7.5 7.5s3.3 7.5 7.5 7.5c4.2-.1 7.5-3.4 7.5-7.5z"></path></svg></span><span style="display:inline-block;padding:2px 3px;">Sanwal Deen</span></a>
				</section>




				<section>
					<h2>How do indexes work?</h2>
					<p>From <a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/mysql-indexes.html">MySQL documentation on indexes</a></p>
					<blockquote cite="https://dev.mysql.com/doc/refman/5.7/en/mysql-indexes.html">Indexes are used to find rows with specific column values quickly. Without an index, MySQL must begin with the first row and then read through the entire table to find the relevant rows. The larger the table, the more this costs. If the table has an index for the columns in question, MySQL can quickly determine the position to seek to in the middle of the data file without having to look at all the data. This is much faster than reading every row sequentially.</blockquote>
					<aside class="notes">
						<p>Extra data stored in the same physical file as the InnoDB tables. Indexes are table specific.</p>
					</aside>
				</section>




				<section>
					<h2>Why are they important?</h2>
					<p>In short: well designed indexes will get you the data in a fast, efficient manner.</p>
					<p>You can do more on the same hardware => cheaper hosting => faster site => happier customers => more income / profit</p>
				</section>




				<section>
					<h2>Columns, data types</h2>
					<ul>
						<li>numeric: INTEGER, BIGINT, SIGNED / UNSIGNED</li>
						<li>string: TEXT, VARCHAR, LONGTEXT</li>
						<li>date type: DATE, TIMESTAMP, DATETIME</li>
						<li>specifying character lengths: VARCHAR(191), BIGINT(20)</li>
					</ul>
					<div class="fragment">
						<p>Examples of signed / unsigned. "Can it have a negative sign?". Highest binary place is the sign</p>
						<pre><code class="php" data-trim>
							// signed -127 – +127
							011111111 = +127
							111111111 = -127

							// unsigned 0 – 255
							011111111 = 127
							111111111 = 255
						</code></pre>
					</div>
				</section>




				<section>
					<h1>What / how should be indexed?</h1>
					<p>From <a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/optimization-indexes.html">MySQL documentation on optimization and indexes</a></p>
					<blockquote cite="https://dev.mysql.com/doc/refman/5.7/en/optimization-indexes.html">Although it can be tempting to create an indexes for every possible column used in a query, unnecessary indexes waste space and waste time for MySQL to determine which indexes to use. Indexes also add to the cost of inserts, updates, and deletes because each index must be updated. You must find the right balance to achieve fast queries using the optimal set of indexes.</blockquote>
				</section>

				<section>
					<h1>What / how should be indexed?</h1>
					<p>"Indexes are less important for queries on small tables, or big tables where report queries process most or all of the rows. When a query needs to access most of the rows, reading sequentially is faster than working through an index. Sequential reads minimize disk seeks, even if not all the rows are needed for the query. See Section 8.2.1.19, “Avoiding Full Table Scans” for details."</p>

					<p><a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/mysql-indexes.html">MySQL doc / Indexes</a></p>
					<p><a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/table-scan-avoidance.html">MySQL doc / Full table scan</a></p>
				</section>




				<section>
					<h2>Unique / multi index</h2>
					<p><strong>UNIQUE:</strong> one value can only appear once in a row. Trying to insert same value will result in a database error message. Super fast <br><em>Example: post IDs</em></p>
					<p><strong>Multi index: </strong>same value can repeat. Still fast, though additional filtering required. <br><em>Example: postmeta_key</em></p>
				</section>




				<section>
					<h2>NULL values in indexes</h2>
					<p>From <a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/optimizing-innodb-queries.html">optimizing InnoDB queries</a></p>
					<blockquote cite="https://dev.mysql.com/doc/refman/5.7/en/optimizing-innodb-queries.html">If an indexed column cannot contain any NULL values, declare it as NOT NULL when you create the table. The optimizer can better determine which index is most effective to use for a query, when it knows whether each column contains NULL values.</blockquote>
					<p><strong>tldr;</strong> if it shouldn't be NULL, declare it so. It will be faster.</p>
					<p><strong>protip: </strong>primary keys will always be NOT NULL!</p>
					<p><strong>protip2: </strong>unique keys permit multiple NULL values!</p>
					<aside class="notes">
						<p>PRIMARY KEY: <br><br>A unique index where all key columns must be defined as NOT NULL. If they are not explicitly declared as NOT NULL, MySQL declares them so implicitly (and silently). A table can have only one PRIMARY KEY. The name of a PRIMARY KEY is always PRIMARY, which thus cannot be used as the name for any other kind of index.</p>
						<p>UNIQUE KEY:<br><br>A UNIQUE index creates a constraint such that all values in the index must be distinct. An error occurs if you try to add a new row with a key value that matches an existing row. For all engines, a UNIQUE index permits multiple NULL values for columns that can contain NULL.</p>
					</aside>
				</section>




				<section>
					<h2>Compound indexes</h2>
					<pre><code class="sql" data-trim data-noescape>
						-- given these columns
						-- ID, post_name, post_date

						CREATE INDEX (`ID`, `post_name`, `post_date`)
						-- will result in a compound index across ID, post_name, post_date, in that order
					</code></pre>
					<p>“If the table has a multiple-column index, any leftmost prefix of the index can be used by the optimizer to look up rows.”</p>
					<pre><code class="sql" data-trim>
						SELECT * FROM table WHERE `ID` = x, `post_name` = y        -- uses index (1,2)
						SELECT * FROM table WHERE `ID` = x                         -- uses index (1)
						SELECT * FROM table WHERE `ID` = x, `post_date` = z        -- NOT using index (1,3)
						SELECT * FROM table WHERE `post_name` = y, `post_date` = z -- NOT using index (2,3)
						SELECT * FROM table WHERE `post_name` = y                  -- NOT using index (2)
					</code></pre>
				</section>




				<section data-transition="slide-in none">
					<h1>WP DB - posts</h1>
					<img src="assets/pix/posts.png" alt="">
					<aside class="notes">
						Raw capture of the entire posts table.
					</aside>
				</section>




				<section data-transition="none">
					<h1>WP DB - posts</h1>
					<img src="assets/pix/posts-unsigned.png" alt="">
					<aside class="notes">
						Highlighted the unsigned part. Reason post_parent and ID have the same type and length is because post_parent refers to an ID. post_author refers to an ID in the users table, which is also the same type / length. And because IDs cannot be negative, unsigned makes sense.
					</aside>
				</section>




				<section data-transition="none">
					<section>
						<h1>WP DB - posts</h1>
						<img src="assets/pix/posts-unique.png" alt="">
						<aside class="notes">
							There's a bug in Sequel pro in giving us the Key type. It should be PRI because:

							"If Key is MUL, the column is the first column of a nonunique index in which multiple occurrences of a given value are permitted within the column.

							If more than one of the Key values applies to a given column of a table, Key displays the one with the highest priority, in the order PRI, UNI, MUL."

							https://dev.mysql.com/doc/refman/5.7/en/show-columns.html
						</aside>
					</section>

					<section>
						<pre class="stretch"><code class="sql" data-trim>
							MariaDB [dev.dev]> show columns from wp_posts;
							+-----------------------+---------------------+------+-----+---------------------+----------------+
							| Field                 | Type                | Null | Key | Default             | Extra          |
							+-----------------------+---------------------+------+-----+---------------------+----------------+
							| ID                    | bigint(20) unsigned | NO   | PRI | NULL                | auto_increment |
							| post_author           | bigint(20) unsigned | NO   | MUL | 0                   |                |
							| post_date             | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
							| post_date_gmt         | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
							| post_content          | longtext            | NO   |     | NULL                |                |
							| post_title            | text                | NO   |     | NULL                |                |
							| post_excerpt          | text                | NO   |     | NULL                |                |
							| post_status           | varchar(20)         | NO   |     | publish             |                |
							| comment_status        | varchar(20)         | NO   |     | open                |                |
							| ping_status           | varchar(20)         | NO   |     | open                |                |
							| post_password         | varchar(255)        | NO   |     |                     |                |
							| post_name             | varchar(200)        | NO   | MUL |                     |                |
							| to_ping               | text                | NO   |     | NULL                |                |
							| pinged                | text                | NO   |     | NULL                |                |
							| post_modified         | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
							| post_modified_gmt     | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
							| post_content_filtered | longtext            | NO   |     | NULL                |                |
							| post_parent           | bigint(20) unsigned | NO   | MUL | 0                   |                |
							| guid                  | varchar(255)        | NO   |     |                     |                |
							| menu_order            | int(11)             | NO   |     | 0                   |                |
							| post_type             | varchar(20)         | NO   | MUL | post                |                |
							| post_mime_type        | varchar(100)        | NO   |     |                     |                |
							| comment_count         | bigint(20)          | NO   |     | 0                   |                |
							+-----------------------+---------------------+------+-----+---------------------+----------------+
							23 rows in set (0.00 sec)
						</code></pre>
					</section>
				</section>






				<section data-transition="none slide-out">
					<h1>WP DB - posts</h1>
					<img src="assets/pix/posts-compound.png" alt="">
				</section>



				<section>
					<h1>WP DB - postmeta</h1>
					<img src="assets/pix/postmeta-highlight.png" alt="postmeta table structure">
					<p>Why 191? - InnoDB key prefix limit is 767 bytes. WP tables use utf8mb4 charset, that's 4 bytes per character. 767 / 4 = 191.75, flooring that is 191. <strong>Only 191 characters fit into the key prefix.</strong></p>
				</section>



				<section>
					<h1>WP DB - posts - EXPLAIN</h1>
					<img src="assets/pix/explain-primary.png" alt="">
				</section>




				<section>
					<h1>WP DB - posts - EXPLAIN</h1>
					<img src="assets/pix/explain-compound-single-notfound.png" alt="">
				</section>




				<section>
					<h1>WP DB - posts - EXPLAIN</h1>
					<img src="assets/pix/explain-compound-multiple-found.png" alt="">
				</section>




				<section>
					<h1>WP DB - posts - EXPLAIN</h1>
					<img src="assets/pix/explain-compound-multiple-range-found.png" alt="">
				</section>




				<section>
					<h1>WP DB - posts - EXPLAIN</h1>
					<img src="assets/pix/explain-compound-multiple-notfound.png" alt="">
				</section>




				<section>
					<section>
						<h1>WP DB - posts - EXPLAIN</h1>
						<img src="assets/pix/explain-compound-multiple-found-2.png" alt="">
					</section>

					<section>
						<h1>WP DB - posts - Query</h1>
						<img src="assets/pix/compound-multiple-found-2.png" alt="">
					</section>
				</section>




				<section>
					<h1>WP DB - posts - EXPLAIN</h1>
					<img src="assets/pix/explain-compound-multiple-id-exact-found.png" alt="">
				</section>




				<section>
					<section>
						<h1>WP DB - posts - EXPLAIN</h1>
						<img src="assets/pix/explain-compound-multiple-id-range-found.png" alt="">
					</section>

					<section>
						<h1>WP DB - posts - Query</h1>
						<img src="assets/pix/compound-multiple-id-range-found-14-69.png" alt="">
					</section>

				</section>




				<section>
					<h1>Using WP_Query</h1>
					<p>By the way the previous is why WP Query forces you to declare a post_type, otherwise defaults to post.</p>
					<pre><code class="php" data-trim>
						// in class-wp-query.php line 2281 in version 4.8.1
						// method get_posts()
						} else {
							$where .= " AND {$wpdb->posts}.post_type = 'post'";
							$post_type_object = get_post_type_object ( 'post' );
						}
					</code></pre>
					<p>If there was no post_type declaration, lots of queries would skip using the index.</p>
				</section>




				<section>
					<h1>ORDER BY</h1>
					<p>Think carefully what to use for order by. The full list is on <a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/order-by-optimization.html">MySQL docs on ORDER BY optimization</a>.</p>
					<p>Tips:</p>
					<ul>
						<li>The larger the data to order, the slower it'll be.</li>
						<li>Indexes can be used to order by if "if the ORDER BY does not match the index exactly, as long as all unused portions of the index and all extra ORDER BY columns are constants in the WHERE clause."</li>
					</ul>
					<p><a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/order-by-optimization.html">MySQL doc / ORDER BY optimization</a></p>

				</section>

				<section>
					<h1>ORDER BY</h1>
					<p>These <strong>will</strong> use index:</p>
					<pre class="stretch"><code class="sql" data-trim>
						-- same compound key, consecutive, no WHERE clause
						SELECT * FROM t1
						  ORDER BY key_part1, key_part2;

						-- key_part1 in WHERE with constant (not column), key_part2 in order by
						SELECT * FROM t1
						  WHERE key_part1 = constant
						  ORDER BY key_part2;

						-- key_part1 is compared to constant, same key used in order by
						SELECT * FROM t1
						  WHERE key_part1 > constant
						  ORDER BY key_part1 ASC;

						-- key parts compared to constants, order by uses same key part
						SELECT * FROM t1
						  WHERE key_part1 = constant1 AND key_part2 > constant2
						  ORDER BY key_part2;
					</code></pre>

					<p><a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/order-by-optimization.html">MySQL doc / ORDER BY optimization</a></p>
				</section>



				<section>
					<h1>ORDER BY</h1>
					<p>These <strong>will not</strong> use index though:</p>
					<pre><code class="sql" data-trim>
						-- Query uses two different indexes
						SELECT * FROM t1 ORDER BY key1, key2;

						-- non-consecutive compound index parts in order by
						SELECT * FROM t1 WHERE key2=constant ORDER BY key_part1, key_part3;

						-- mixes ASC and DESC
						SELECT * FROM t1 ORDER BY key_part1 DESC, key_part2 ASC;

						-- key in WHERE and key in ORDER BY are different
						SELECT * FROM t1 WHERE key2=constant ORDER BY key1;

						-- order by is an expression other than the index (needs calculation)
						SELECT * FROM t1 ORDER BY ABS(key);
						SELECT * FROM t1 ORDER BY -key;
					</code></pre>
					<p><a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/order-by-optimization.html">MySQL doc / ORDER BY optimization</a></p>
				</section>

				<section>
					<h1>GROUP BY</h1>
					<p>Either creates a temporary table, or uses indexes in VERY SPECIFIC cases.</p>
					<p>Douglas Adam's words apply to Group By too:</p>
					<blockquote>
						The Encyclopedia Galactica, in its chapter on Love states that it is far too complicated to define. The Hitchhiker's Guide to the Galaxy has this to say on the subject of love: Avoid, if at all possible. Unfortunately, Arthur Dent has never read the Hitchhiker's Guide to the Galaxy.
					</blockquote>
					<p><a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/group-by-optimization.html">MySQL doc / GROUP BY optimization</a></p>

				</section>



				<section>
					<h1>JOINs</h1>
					<p>most efficient if indexes on colums are declared same type and size. Which is why all ID fields are BIGINT(20) in WP.</p>
					<p>VARCHAR and CHAR are considered the same if their sizes match. VARCHAR(10) == CHAR(10).</p>
					<p>Use same charset (this is usually taken care of for you)</p>
					<p>Do not use columns that need type juggling though. eg numeric 1 and string '1', '00001', ' 1', '01.e1', etc</p>
					<p><a target="_blank" href="https://dev.mysql.com/doc/refman/5.7/en/mysql-indexes.html">MySQL doc on indexes</a></p>
				</section>


				<section>
					<h1>same table / new rel table?</h1>
					<p>Hypothetical WooCommerce Orders new table structure</p>
					<ul>
						<li>Is data required, and there's only one per order? => Same table, new colum! eg order total</li>
						<li>Is data optional, but there can only be one per order? => Same table, allow NULL</li>
						<li>Is data required, but there can be multiple per order? => new rigid table, for example list of coupons, list of line items</li>
						<li>Is data optional, is it arbitrary? => new general table, key-value pair, much like postmeta</li>
					</ul>
				</section>


				<section>
					<h1>deleting records</h1>
					<p>delete things from wp_posts</p>
					<p>then need to clean up in wp_postmeta</p>
					<p>... and terms</p>
					<p>... and comments</p>
					<p>... and taxonomy relationships...</p>
					<p class="fragment">The solution is (would be)</p>
					<p class="fragment">Foreign keys!!</p>
				</section>


				<section>
					<h1>Foreign Keys</h1>
					<p>foreign keys are constraints imposed on the database that keeps data across multiple tables consistent</p>
					<pre><code class="sql" data-trim>
						CREATE TABLE parent (
						    id INT NOT NULL,
						    PRIMARY KEY (id)
						) ENGINE=INNODB;

						CREATE TABLE child (
						    id INT,
						    parent_id INT,
						    INDEX par_ind (parent_id),
						    FOREIGN KEY (parent_id)
						        REFERENCES parent(id)
						        ON DELETE CASCADE
						) ENGINE=INNODB;
					</code></pre>
				</section>


				<section>
					<h1>Foreign Keys</h1>
					<p>You can't insert data that doesn't belong to something that already exists in the main table.</p>
					<p>Can't drop table that has other tables depending on it.</p>
				</section>

				<section>
					<h1>Foreign Keys</h1>
					<pre><code class="sql" data-trim>ON DELETE CASCADE</code></pre>
					<p>if I delete the main record in parent, everything else that had its foreign key constrained to THAT id will automatically be deleted with it. Automatic cleanup! No more hunting for orphan data!</p>
					<p class="fragment">Of course it's not implemented in WordPress, mostly due to backwards compat reasons. (<a target="_blank" href="https://core.trac.wordpress.org/ticket/19207#comment:3">Trac 19207</a>)</p>
				</section>


				<section>
					<h1>Tools</h1>
					<ul>
						<li>NewRelic APM configured to give you slow queries</li>
						<li>MySQL Workbench / Seqel Pro / mysql cli for the EXPLAIN queries. Please don't use phpmyadmin for this even though it COULD.</li>
						<li>Blackfire.io</li>
					</ul>
				</section>



				<section>
					<h2>Tools - New Relic</h2>
					<img src="assets/pix/newrelic-sql-trace.png" alt="sql trace in new relic">
					<p><a href="https://newrelic.com/">New Relic</a></p>
				</section>

				<section>
					<h2>Tools - Blackfire</h2>
					<img src="assets/pix/blackfire-sql-trace.png" alt="sql trace in blackfire">
					<p><a href="https://blackfire.io/">Blackfire</a></p>
				</section>


				<section>
					<h2>Tools - Sequel Pro</h2>
					<img src="assets/pix/pancakes.png" alt="sequel pro window">
					<p><a href="https://www.sequelpro.com/">Sequel Pro aka "Pancakes"</a></p>
				</section>



				<section>
					<h1>Tips</h1>
					<ul>
						<li>You can't do much to WordPress database schema without breaking something</li>
						<li>rethink your theme / plugin / customisation code to make sure your queries use indexes</li>
						<li>rethink your theme / plugin's data storage schema to make sure you're not wasting resources</li>
						<li>learn more about MySQL. Their documentation is A++ 10/10 would recommend (or 5/7 for those who understand it)</li>
						<li>use profiling tools to find where the bottlenecks are</li>
						<li>you can always hire someone who knows how to database too</li>
					</ul>
				</section>


				<section>
					<h1>終わり</h1>
					<h2>(owari – the end)</h2>
					<h2>Questions?</h2>
					<h3>@javorszky</h3>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
